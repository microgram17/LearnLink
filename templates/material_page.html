{% extends "base.html" %}

{% block title %}Material{% endblock %}

{% block content %}
<section class="content">
    <section class="content-21">
        <div class="post-content-21">
            <h1>{{ material.post_title }}</h1>
            <p>{{ material.post_body | make_links | safe }}</p>
            {% for attachment in material.files_attached %}
                {% if attachment.file_type == 'video' %}
                    <div>
                        <iframe width="560" height="315" src="https://www.youtube.com/embed/{{ attachment.file_url.split('/')[-1] }}" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe>
                    </div>
                {% endif %}
            {% endfor %}
        </div>
    </section>

    <section class="comments-section">
        <h2>Comments</h2>
        <form method="POST">
            {{ comment_form.hidden_tag() }}
            <div class="form-group">
                {{ comment_form.comment_text.label }}
                {{ comment_form.comment_text(class="form-control") }}
            </div>
            <div class="form-group">
                {{ comment_form.submit(class="btn btn-primary") }}
            </div>
        </form>

        <ul class="comments">
            {% for comment in comments %}
                {% with comment=comment %}
                    {% include 'comment.html' %}
                {% endwith %}
            {% endfor %}
        </ul>
    </section>
</section>

<script>
    function showReplyForm(commentId) {
        // Hide all active reply forms
        document.querySelectorAll('.reply-form.active').forEach(function(form) {
            form.classList.remove('active');
        });

        // Show the selected reply form
        var replyForm = document.getElementById('reply-form-' + commentId);
        replyForm.classList.add('active');
    }
</script>
{% endblock %}
